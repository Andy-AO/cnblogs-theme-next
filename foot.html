<footer class="footer">
  <div class="footer-inner">
    <div class="beian"><a href="http://www.beian.miit.gov.cn" rel="noopener external nofollow noreferrer"
        target="_blank" class="exturl">陕ICP备16017712号-1</a></div>
    <div class="copyright">© 2017 – <span itemprop="copyrightYear">2020</span> <span class="with-love"><i
          class="fa fa-heartbeat"></i> </span><span class="author" itemprop="copyrightHolder">Gao Yuting</span>
    </div>
  </div>
</footer>
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Noto Serif SC:wght@400;500;700&display=swap&subset=latin,latin-ext">
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript">
  function setDesc() {
    $('#cnblogs_post_description').css('display','block')
    $('#cnblogs_post_description').prepend('<h3 id="post-description-meta">摘 要</h3>')
    $.ajax({
      url: getAjaxBaseUrl() + "CategoriesTags.aspx",
      type: "get",
      contentType: "application/json; charset=utf-8",
      data: {
          blogId: cb_blogId,
          postId: cb_entryId,
      },
      cache: !1,
      dataType: "text",
      timeout: 1e4,
      success: function(n) {
          n && $("#cnblogs_post_description").append(n.replace('EntryTag','post-keyword').replace('标签','关键词'))
          $('#EntryTag').remove()
      }
    })
  }
  function setFoot() {
    $('.footnotes').prepend('<h2 id="-参考文献" class="footnotes-meta">参 考 文 献</h2>')
  }
  function setContent() {
    $('#blog-news').prepend('<div id="post-toc-wrap"><h3 style="text-align:center">目录</h3></div>')
    var captions_ori = $("#cnblogs_post_body h2"),
      captions_ori2 = $("#cnblogs_post_body h3"),
      captions = $("#cnblogs_post_body h2,#cnblogs_post_body h3").clone(),
      content = $("<ol id='post-toc'></ol>");
    
    $("#post-toc-wrap").append(content.append(captions));
    var index = -1,index2 = -1;
    captions.replaceWith(function(){
        var self = this;
        if(self.tagName == "H2" || self.tagName == "h2"){
            // 设置点击目录跳转
            index += 1;
            $('<a name="' + '_caption_' + index + '"></a>').insertBefore(captions_ori[index]); 
            return '<li id="'+index+'li"><a href="#_caption_' + index + '">' + self.innerHTML + '</a><ol></ol></li>';
        } else {
          // add by summertime-wu 增加h3链接跳转
          index2 += 1;
          $('<a name="' + '_caption' + index2 + '"></a>').insertBefore(captions_ori2[index2]); 
          $("#"+index+"li ol").append("<li><a href='#_caption" + index2 + "' style='color:#5f5f5f;'>" +self.innerHTML+"</a></li>");
            return ;
        }
    });

    //通过滚动条控制导航条的展现隐藏
    var oldScrollNum = 0;
    window.onscroll = function(){
      var t = document.documentElement.scrollTop || document.body.scrollTop;
      //下滑
      if (t>oldScrollNum) {
        if (t>270) {
          $("#post-toc-wrap").addClass("affix");
        }
      //上拉
      }else{
        if (t<=270) {
          $("#post-toc-wrap").removeClass("affix");
        }
      }
      oldScrollNum = t;
    }
  }
  function setAuthor() {
    var html = $('#author_profile_info').html()
    $('#post-toc-wrap').append('<h3 style="text-align:center">作者</h3>'+html)
    $('#author_profile_info').remove()
  }
  if($('.forFlow').find('#post_detail').length) {
    setTimeout(() => {
      setFoot();
      setDesc();
      setContent();
      setAuthor()
    }, 1000);
  }
</script>